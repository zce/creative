"use strict";

var qs = document.querySelector.bind(document);
var qsa = document.querySelectorAll.bind(document);

function loadStyle(href) {
  var linkElement = document.createElement('link');
  linkElement.rel = 'stylesheet';
  linkElement.type = 'text/css';
  linkElement.href = href;
  document.head.appendChild(linkElement);
}

function loadScript(src, callback) {
  var scriptElement = document.createElement('script');
  scriptElement.src = src;
  callback && scriptElement.addEventListener('load', callback);
  document.body.appendChild(scriptElement);
} // search
// -----------------------------------------------------------------------------


;

(function () {
  var input = qs('#search_input');
  if (!input) return false;
  loadScript('https://unpkg.com/ghost-search/dist/ghost-search.js', function () {
    var result = document.createElement('div');
    result.id = 'search_result';
    result.className = 'dropdown-menu dropdown-menu-right';
    result.innerHTML = "<span class=\"dropdown-item disabled\">".concat(input.placeholder, "...</span>");
    input.parentElement.classList.add('dropdown');
    input.parentElement.appendChild(result);
    /* eslint-disable no-new */

    new window.GhostSearch({
      input: '#search_input',
      results: '#search_result',
      template: function template(i) {
        return "<a class=\"dropdown-item\" href=\"".concat(i.url, "\">").concat(i.title, "</a>");
      },
      api: {
        parameters: {
          fields: ['url', 'title']
        }
      },
      on: {
        afterDisplay: function afterDisplay(results) {
          if (results.total !== 0) return false;
          if (!input.value) return false;
          result.innerHTML = "<span class=\"dropdown-item disabled\">No results</span>";
        }
      }
    });
  });
})() // img lazyload
// -----------------------------------------------------------------------------
;

(function () {
  if (!qs('.post-card [data-src]')) return false;
  loadScript('https://unpkg.com/vanilla-lazyload', function () {
    window.lazyloader = new window.LazyLoad({
      elements_selector: '.post-card [data-src]'
    });
  });
})() // highlight prismjs
// -----------------------------------------------------------------------------
;

(function () {
  var elements = qsa('.post-content pre code');
  if (!elements.length) return false; // code card polyfill

  elements.forEach(function (item) {
    item.classList.length || item.classList.add('language-basic');
  });
  loadStyle('https://unpkg.com/prismjs/themes/prism-okaidia.css');
  loadScript('https://unpkg.com/prismjs/prism.js');
})() // gallery
// -----------------------------------------------------------------------------
;

(function () {
  qsa('.kg-gallery-image img').forEach(function (item) {
    var container = item.closest('.kg-gallery-image');
    var width = item.attributes.width.value;
    var height = item.attributes.height.value;
    var ratio = width / height;
    container.style.flex = ratio + ' 1 0%';
  }); // preview

  var elements = qsa('.kg-gallery-container');
  if (!elements.length) return false;
  loadStyle('https://unpkg.com/lightgallery.js/dist/css/lightgallery.min.css');
  loadScript('https://unpkg.com/lightgallery.js/dist/js/lightgallery.js', function () {
    elements.forEach(function (item) {
      item.querySelectorAll('.kg-gallery-image').forEach(function (sub) {
        sub.dataset.src = sub.children[0].src;
      });
      window.lightGallery(item, {
        selector: '.kg-gallery-image'
      });
    });
  });
})() // TODO: post share
// -----------------------------------------------------------------------------
;

(function () {
  qsa('.post-share a').forEach(function (item) {
    return item.addEventListener('click', function (e) {
      window.open(e.currentTarget.href, 'share-window', 'width=640,height=360');
      e.preventDefault();
    });
  });
})() // subscribe hidden form value
// -----------------------------------------------------------------------------
;

(function () {
  qsa('input[name=location]').forEach(function (item) {
    item.value = item.value || location.href;
  });
  qsa('input[name=referrer]').forEach(function (item) {
    item.value = item.value || document.referrer;
  });
})() // site preloader
// -----------------------------------------------------------------------------
;

(function () {
  var loader = qs('.site-preloader');

  if (loader) {
    loader.style.opacity = 0;
    setTimeout(function () {
      return loader.parentElement.removeChild(loader);
    }, 1000);
  }
})();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdsb2JhbC5qcyJdLCJuYW1lcyI6WyJxcyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImJpbmQiLCJxc2EiLCJxdWVyeVNlbGVjdG9yQWxsIiwibG9hZFN0eWxlIiwiaHJlZiIsImxpbmtFbGVtZW50IiwiY3JlYXRlRWxlbWVudCIsInJlbCIsInR5cGUiLCJoZWFkIiwiYXBwZW5kQ2hpbGQiLCJsb2FkU2NyaXB0Iiwic3JjIiwiY2FsbGJhY2siLCJzY3JpcHRFbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImJvZHkiLCJpbnB1dCIsInJlc3VsdCIsImlkIiwiY2xhc3NOYW1lIiwiaW5uZXJIVE1MIiwicGxhY2Vob2xkZXIiLCJwYXJlbnRFbGVtZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwid2luZG93IiwiR2hvc3RTZWFyY2giLCJyZXN1bHRzIiwidGVtcGxhdGUiLCJpIiwidXJsIiwidGl0bGUiLCJhcGkiLCJwYXJhbWV0ZXJzIiwiZmllbGRzIiwib24iLCJhZnRlckRpc3BsYXkiLCJ0b3RhbCIsInZhbHVlIiwibGF6eWxvYWRlciIsIkxhenlMb2FkIiwiZWxlbWVudHNfc2VsZWN0b3IiLCJlbGVtZW50cyIsImxlbmd0aCIsImZvckVhY2giLCJpdGVtIiwiY29udGFpbmVyIiwiY2xvc2VzdCIsIndpZHRoIiwiYXR0cmlidXRlcyIsImhlaWdodCIsInJhdGlvIiwic3R5bGUiLCJmbGV4Iiwic3ViIiwiZGF0YXNldCIsImNoaWxkcmVuIiwibGlnaHRHYWxsZXJ5Iiwic2VsZWN0b3IiLCJlIiwib3BlbiIsImN1cnJlbnRUYXJnZXQiLCJwcmV2ZW50RGVmYXVsdCIsImxvY2F0aW9uIiwicmVmZXJyZXIiLCJsb2FkZXIiLCJvcGFjaXR5Iiwic2V0VGltZW91dCIsInJlbW92ZUNoaWxkIl0sIm1hcHBpbmdzIjoiOztBQUFBLElBQU1BLEVBQUUsR0FBR0MsUUFBUSxDQUFDQyxhQUFULENBQXVCQyxJQUF2QixDQUE0QkYsUUFBNUIsQ0FBWDtBQUNBLElBQU1HLEdBQUcsR0FBR0gsUUFBUSxDQUFDSSxnQkFBVCxDQUEwQkYsSUFBMUIsQ0FBK0JGLFFBQS9CLENBQVo7O0FBRUEsU0FBU0ssU0FBVCxDQUFvQkMsSUFBcEIsRUFBMEI7QUFDeEIsTUFBTUMsV0FBVyxHQUFHUCxRQUFRLENBQUNRLGFBQVQsQ0FBdUIsTUFBdkIsQ0FBcEI7QUFDQUQsRUFBQUEsV0FBVyxDQUFDRSxHQUFaLEdBQWtCLFlBQWxCO0FBQ0FGLEVBQUFBLFdBQVcsQ0FBQ0csSUFBWixHQUFtQixVQUFuQjtBQUNBSCxFQUFBQSxXQUFXLENBQUNELElBQVosR0FBbUJBLElBQW5CO0FBQ0FOLEVBQUFBLFFBQVEsQ0FBQ1csSUFBVCxDQUFjQyxXQUFkLENBQTBCTCxXQUExQjtBQUNEOztBQUVELFNBQVNNLFVBQVQsQ0FBcUJDLEdBQXJCLEVBQTBCQyxRQUExQixFQUFvQztBQUNsQyxNQUFNQyxhQUFhLEdBQUdoQixRQUFRLENBQUNRLGFBQVQsQ0FBdUIsUUFBdkIsQ0FBdEI7QUFDQVEsRUFBQUEsYUFBYSxDQUFDRixHQUFkLEdBQW9CQSxHQUFwQjtBQUNBQyxFQUFBQSxRQUFRLElBQUlDLGFBQWEsQ0FBQ0MsZ0JBQWQsQ0FBK0IsTUFBL0IsRUFBdUNGLFFBQXZDLENBQVo7QUFDQWYsRUFBQUEsUUFBUSxDQUFDa0IsSUFBVCxDQUFjTixXQUFkLENBQTBCSSxhQUExQjtBQUNELEMsQ0FFRDtBQUNBOzs7QUFDQTs7QUFBQyxDQUFDLFlBQU07QUFDTixNQUFNRyxLQUFLLEdBQUdwQixFQUFFLENBQUMsZUFBRCxDQUFoQjtBQUNBLE1BQUksQ0FBQ29CLEtBQUwsRUFBWSxPQUFPLEtBQVA7QUFFWk4sRUFBQUEsVUFBVSxDQUFDLHFEQUFELEVBQXdELFlBQU07QUFDdEUsUUFBTU8sTUFBTSxHQUFHcEIsUUFBUSxDQUFDUSxhQUFULENBQXVCLEtBQXZCLENBQWY7QUFDQVksSUFBQUEsTUFBTSxDQUFDQyxFQUFQLEdBQVksZUFBWjtBQUNBRCxJQUFBQSxNQUFNLENBQUNFLFNBQVAsR0FBbUIsbUNBQW5CO0FBQ0FGLElBQUFBLE1BQU0sQ0FBQ0csU0FBUCxvREFBMkRKLEtBQUssQ0FBQ0ssV0FBakU7QUFDQUwsSUFBQUEsS0FBSyxDQUFDTSxhQUFOLENBQW9CQyxTQUFwQixDQUE4QkMsR0FBOUIsQ0FBa0MsVUFBbEM7QUFDQVIsSUFBQUEsS0FBSyxDQUFDTSxhQUFOLENBQW9CYixXQUFwQixDQUFnQ1EsTUFBaEM7QUFFQTs7QUFDQSxRQUFJUSxNQUFNLENBQUNDLFdBQVgsQ0FBdUI7QUFDckJWLE1BQUFBLEtBQUssRUFBRSxlQURjO0FBRXJCVyxNQUFBQSxPQUFPLEVBQUUsZ0JBRlk7QUFHckJDLE1BQUFBLFFBQVEsRUFBRSxrQkFBQUMsQ0FBQztBQUFBLDJEQUFzQ0EsQ0FBQyxDQUFDQyxHQUF4QyxnQkFBZ0RELENBQUMsQ0FBQ0UsS0FBbEQ7QUFBQSxPQUhVO0FBSXJCQyxNQUFBQSxHQUFHLEVBQUU7QUFDSEMsUUFBQUEsVUFBVSxFQUFFO0FBQUVDLFVBQUFBLE1BQU0sRUFBRSxDQUFDLEtBQUQsRUFBUSxPQUFSO0FBQVY7QUFEVCxPQUpnQjtBQU9yQkMsTUFBQUEsRUFBRSxFQUFFO0FBQ0ZDLFFBQUFBLFlBQVksRUFBRSxzQkFBQVQsT0FBTyxFQUFJO0FBQ3ZCLGNBQUlBLE9BQU8sQ0FBQ1UsS0FBUixLQUFrQixDQUF0QixFQUF5QixPQUFPLEtBQVA7QUFDekIsY0FBSSxDQUFDckIsS0FBSyxDQUFDc0IsS0FBWCxFQUFrQixPQUFPLEtBQVA7QUFDbEJyQixVQUFBQSxNQUFNLENBQUNHLFNBQVA7QUFDRDtBQUxDO0FBUGlCLEtBQXZCO0FBZUQsR0F4QlMsQ0FBVjtBQXlCRCxDQTdCQSxJQStCRDtBQUNBO0FBaENDOztBQWlDQSxDQUFDLFlBQU07QUFDTixNQUFJLENBQUN4QixFQUFFLENBQUMsdUJBQUQsQ0FBUCxFQUFrQyxPQUFPLEtBQVA7QUFFbENjLEVBQUFBLFVBQVUsQ0FBQyxvQ0FBRCxFQUF1QyxZQUFNO0FBQ3JEZSxJQUFBQSxNQUFNLENBQUNjLFVBQVAsR0FBb0IsSUFBSWQsTUFBTSxDQUFDZSxRQUFYLENBQW9CO0FBQ3RDQyxNQUFBQSxpQkFBaUIsRUFBRTtBQURtQixLQUFwQixDQUFwQjtBQUdELEdBSlMsQ0FBVjtBQUtELENBUkEsSUFVRDtBQUNBO0FBWEM7O0FBWUEsQ0FBQyxZQUFNO0FBQ04sTUFBTUMsUUFBUSxHQUFHMUMsR0FBRyxDQUFDLHdCQUFELENBQXBCO0FBQ0EsTUFBSSxDQUFDMEMsUUFBUSxDQUFDQyxNQUFkLEVBQXNCLE9BQU8sS0FBUCxDQUZoQixDQUdOOztBQUNBRCxFQUFBQSxRQUFRLENBQUNFLE9BQVQsQ0FBaUIsVUFBQUMsSUFBSSxFQUFJO0FBQ3ZCQSxJQUFBQSxJQUFJLENBQUN0QixTQUFMLENBQWVvQixNQUFmLElBQXlCRSxJQUFJLENBQUN0QixTQUFMLENBQWVDLEdBQWYsQ0FBbUIsZ0JBQW5CLENBQXpCO0FBQ0QsR0FGRDtBQUlBdEIsRUFBQUEsU0FBUyxDQUFDLG9EQUFELENBQVQ7QUFDQVEsRUFBQUEsVUFBVSxDQUFDLG9DQUFELENBQVY7QUFDRCxDQVZBLElBWUQ7QUFDQTtBQWJDOztBQWNBLENBQUMsWUFBTTtBQUNOVixFQUFBQSxHQUFHLENBQUMsdUJBQUQsQ0FBSCxDQUE2QjRDLE9BQTdCLENBQXFDLFVBQUFDLElBQUksRUFBSTtBQUMzQyxRQUFNQyxTQUFTLEdBQUdELElBQUksQ0FBQ0UsT0FBTCxDQUFhLG1CQUFiLENBQWxCO0FBQ0EsUUFBTUMsS0FBSyxHQUFHSCxJQUFJLENBQUNJLFVBQUwsQ0FBZ0JELEtBQWhCLENBQXNCVixLQUFwQztBQUNBLFFBQU1ZLE1BQU0sR0FBR0wsSUFBSSxDQUFDSSxVQUFMLENBQWdCQyxNQUFoQixDQUF1QlosS0FBdEM7QUFDQSxRQUFNYSxLQUFLLEdBQUdILEtBQUssR0FBR0UsTUFBdEI7QUFDQUosSUFBQUEsU0FBUyxDQUFDTSxLQUFWLENBQWdCQyxJQUFoQixHQUF1QkYsS0FBSyxHQUFHLE9BQS9CO0FBQ0QsR0FORCxFQURNLENBU047O0FBQ0EsTUFBTVQsUUFBUSxHQUFHMUMsR0FBRyxDQUFDLHVCQUFELENBQXBCO0FBQ0EsTUFBSSxDQUFDMEMsUUFBUSxDQUFDQyxNQUFkLEVBQXNCLE9BQU8sS0FBUDtBQUN0QnpDLEVBQUFBLFNBQVMsQ0FBQyxpRUFBRCxDQUFUO0FBQ0FRLEVBQUFBLFVBQVUsQ0FBQywyREFBRCxFQUE4RCxZQUFNO0FBQzVFZ0MsSUFBQUEsUUFBUSxDQUFDRSxPQUFULENBQWlCLFVBQUFDLElBQUksRUFBSTtBQUN2QkEsTUFBQUEsSUFBSSxDQUFDNUMsZ0JBQUwsQ0FBc0IsbUJBQXRCLEVBQTJDMkMsT0FBM0MsQ0FBbUQsVUFBQVUsR0FBRyxFQUFJO0FBQ3hEQSxRQUFBQSxHQUFHLENBQUNDLE9BQUosQ0FBWTVDLEdBQVosR0FBa0IyQyxHQUFHLENBQUNFLFFBQUosQ0FBYSxDQUFiLEVBQWdCN0MsR0FBbEM7QUFDRCxPQUZEO0FBR0FjLE1BQUFBLE1BQU0sQ0FBQ2dDLFlBQVAsQ0FBb0JaLElBQXBCLEVBQTBCO0FBQUVhLFFBQUFBLFFBQVEsRUFBRTtBQUFaLE9BQTFCO0FBQ0QsS0FMRDtBQU1ELEdBUFMsQ0FBVjtBQVFELENBckJBLElBdUJEO0FBQ0E7QUF4QkM7O0FBeUJBLENBQUMsWUFBTTtBQUNOMUQsRUFBQUEsR0FBRyxDQUFDLGVBQUQsQ0FBSCxDQUFxQjRDLE9BQXJCLENBQTZCLFVBQUFDLElBQUk7QUFBQSxXQUFJQSxJQUFJLENBQUMvQixnQkFBTCxDQUFzQixPQUF0QixFQUErQixVQUFBNkMsQ0FBQyxFQUFJO0FBQ3ZFbEMsTUFBQUEsTUFBTSxDQUFDbUMsSUFBUCxDQUFZRCxDQUFDLENBQUNFLGFBQUYsQ0FBZ0IxRCxJQUE1QixFQUFrQyxjQUFsQyxFQUFrRCxzQkFBbEQ7QUFDQXdELE1BQUFBLENBQUMsQ0FBQ0csY0FBRjtBQUNELEtBSG9DLENBQUo7QUFBQSxHQUFqQztBQUlELENBTEEsSUFPRDtBQUNBO0FBUkM7O0FBU0EsQ0FBQyxZQUFNO0FBQ045RCxFQUFBQSxHQUFHLENBQUMsc0JBQUQsQ0FBSCxDQUE0QjRDLE9BQTVCLENBQW9DLFVBQUFDLElBQUksRUFBSTtBQUFFQSxJQUFBQSxJQUFJLENBQUNQLEtBQUwsR0FBYU8sSUFBSSxDQUFDUCxLQUFMLElBQWN5QixRQUFRLENBQUM1RCxJQUFwQztBQUEwQyxHQUF4RjtBQUNBSCxFQUFBQSxHQUFHLENBQUMsc0JBQUQsQ0FBSCxDQUE0QjRDLE9BQTVCLENBQW9DLFVBQUFDLElBQUksRUFBSTtBQUFFQSxJQUFBQSxJQUFJLENBQUNQLEtBQUwsR0FBYU8sSUFBSSxDQUFDUCxLQUFMLElBQWN6QyxRQUFRLENBQUNtRSxRQUFwQztBQUE4QyxHQUE1RjtBQUNELENBSEEsSUFLRDtBQUNBO0FBTkM7O0FBT0EsQ0FBQyxZQUFNO0FBQ04sTUFBTUMsTUFBTSxHQUFHckUsRUFBRSxDQUFDLGlCQUFELENBQWpCOztBQUNBLE1BQUlxRSxNQUFKLEVBQVk7QUFDVkEsSUFBQUEsTUFBTSxDQUFDYixLQUFQLENBQWFjLE9BQWIsR0FBdUIsQ0FBdkI7QUFDQUMsSUFBQUEsVUFBVSxDQUFDO0FBQUEsYUFBTUYsTUFBTSxDQUFDM0MsYUFBUCxDQUFxQjhDLFdBQXJCLENBQWlDSCxNQUFqQyxDQUFOO0FBQUEsS0FBRCxFQUFpRCxJQUFqRCxDQUFWO0FBQ0Q7QUFDRixDQU5BIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgcXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yLmJpbmQoZG9jdW1lbnQpXG5jb25zdCBxc2EgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsLmJpbmQoZG9jdW1lbnQpXG5cbmZ1bmN0aW9uIGxvYWRTdHlsZSAoaHJlZikge1xuICBjb25zdCBsaW5rRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpbmsnKVxuICBsaW5rRWxlbWVudC5yZWwgPSAnc3R5bGVzaGVldCdcbiAgbGlua0VsZW1lbnQudHlwZSA9ICd0ZXh0L2NzcydcbiAgbGlua0VsZW1lbnQuaHJlZiA9IGhyZWZcbiAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChsaW5rRWxlbWVudClcbn1cblxuZnVuY3Rpb24gbG9hZFNjcmlwdCAoc3JjLCBjYWxsYmFjaykge1xuICBjb25zdCBzY3JpcHRFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0JylcbiAgc2NyaXB0RWxlbWVudC5zcmMgPSBzcmNcbiAgY2FsbGJhY2sgJiYgc2NyaXB0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgY2FsbGJhY2spXG4gIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoc2NyaXB0RWxlbWVudClcbn1cblxuLy8gc2VhcmNoXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuOygoKSA9PiB7XG4gIGNvbnN0IGlucHV0ID0gcXMoJyNzZWFyY2hfaW5wdXQnKVxuICBpZiAoIWlucHV0KSByZXR1cm4gZmFsc2VcblxuICBsb2FkU2NyaXB0KCdodHRwczovL3VucGtnLmNvbS9naG9zdC1zZWFyY2gvZGlzdC9naG9zdC1zZWFyY2guanMnLCAoKSA9PiB7XG4gICAgY29uc3QgcmVzdWx0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICByZXN1bHQuaWQgPSAnc2VhcmNoX3Jlc3VsdCdcbiAgICByZXN1bHQuY2xhc3NOYW1lID0gJ2Ryb3Bkb3duLW1lbnUgZHJvcGRvd24tbWVudS1yaWdodCdcbiAgICByZXN1bHQuaW5uZXJIVE1MID0gYDxzcGFuIGNsYXNzPVwiZHJvcGRvd24taXRlbSBkaXNhYmxlZFwiPiR7aW5wdXQucGxhY2Vob2xkZXJ9Li4uPC9zcGFuPmBcbiAgICBpbnB1dC5wYXJlbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Ryb3Bkb3duJylcbiAgICBpbnB1dC5wYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKHJlc3VsdClcblxuICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLW5ldyAqL1xuICAgIG5ldyB3aW5kb3cuR2hvc3RTZWFyY2goe1xuICAgICAgaW5wdXQ6ICcjc2VhcmNoX2lucHV0JyxcbiAgICAgIHJlc3VsdHM6ICcjc2VhcmNoX3Jlc3VsdCcsXG4gICAgICB0ZW1wbGF0ZTogaSA9PiBgPGEgY2xhc3M9XCJkcm9wZG93bi1pdGVtXCIgaHJlZj1cIiR7aS51cmx9XCI+JHtpLnRpdGxlfTwvYT5gLFxuICAgICAgYXBpOiB7XG4gICAgICAgIHBhcmFtZXRlcnM6IHsgZmllbGRzOiBbJ3VybCcsICd0aXRsZSddIH1cbiAgICAgIH0sXG4gICAgICBvbjoge1xuICAgICAgICBhZnRlckRpc3BsYXk6IHJlc3VsdHMgPT4ge1xuICAgICAgICAgIGlmIChyZXN1bHRzLnRvdGFsICE9PSAwKSByZXR1cm4gZmFsc2VcbiAgICAgICAgICBpZiAoIWlucHV0LnZhbHVlKSByZXR1cm4gZmFsc2VcbiAgICAgICAgICByZXN1bHQuaW5uZXJIVE1MID0gYDxzcGFuIGNsYXNzPVwiZHJvcGRvd24taXRlbSBkaXNhYmxlZFwiPk5vIHJlc3VsdHM8L3NwYW4+YFxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcbiAgfSlcbn0pKClcblxuLy8gaW1nIGxhenlsb2FkXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuOygoKSA9PiB7XG4gIGlmICghcXMoJy5wb3N0LWNhcmQgW2RhdGEtc3JjXScpKSByZXR1cm4gZmFsc2VcblxuICBsb2FkU2NyaXB0KCdodHRwczovL3VucGtnLmNvbS92YW5pbGxhLWxhenlsb2FkJywgKCkgPT4ge1xuICAgIHdpbmRvdy5sYXp5bG9hZGVyID0gbmV3IHdpbmRvdy5MYXp5TG9hZCh7XG4gICAgICBlbGVtZW50c19zZWxlY3RvcjogJy5wb3N0LWNhcmQgW2RhdGEtc3JjXSdcbiAgICB9KVxuICB9KVxufSkoKVxuXG4vLyBoaWdobGlnaHQgcHJpc21qc1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbjsoKCkgPT4ge1xuICBjb25zdCBlbGVtZW50cyA9IHFzYSgnLnBvc3QtY29udGVudCBwcmUgY29kZScpXG4gIGlmICghZWxlbWVudHMubGVuZ3RoKSByZXR1cm4gZmFsc2VcbiAgLy8gY29kZSBjYXJkIHBvbHlmaWxsXG4gIGVsZW1lbnRzLmZvckVhY2goaXRlbSA9PiB7XG4gICAgaXRlbS5jbGFzc0xpc3QubGVuZ3RoIHx8IGl0ZW0uY2xhc3NMaXN0LmFkZCgnbGFuZ3VhZ2UtYmFzaWMnKVxuICB9KVxuXG4gIGxvYWRTdHlsZSgnaHR0cHM6Ly91bnBrZy5jb20vcHJpc21qcy90aGVtZXMvcHJpc20tb2thaWRpYS5jc3MnKVxuICBsb2FkU2NyaXB0KCdodHRwczovL3VucGtnLmNvbS9wcmlzbWpzL3ByaXNtLmpzJylcbn0pKClcblxuLy8gZ2FsbGVyeVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbjsoKCkgPT4ge1xuICBxc2EoJy5rZy1nYWxsZXJ5LWltYWdlIGltZycpLmZvckVhY2goaXRlbSA9PiB7XG4gICAgY29uc3QgY29udGFpbmVyID0gaXRlbS5jbG9zZXN0KCcua2ctZ2FsbGVyeS1pbWFnZScpXG4gICAgY29uc3Qgd2lkdGggPSBpdGVtLmF0dHJpYnV0ZXMud2lkdGgudmFsdWVcbiAgICBjb25zdCBoZWlnaHQgPSBpdGVtLmF0dHJpYnV0ZXMuaGVpZ2h0LnZhbHVlXG4gICAgY29uc3QgcmF0aW8gPSB3aWR0aCAvIGhlaWdodFxuICAgIGNvbnRhaW5lci5zdHlsZS5mbGV4ID0gcmF0aW8gKyAnIDEgMCUnXG4gIH0pXG5cbiAgLy8gcHJldmlld1xuICBjb25zdCBlbGVtZW50cyA9IHFzYSgnLmtnLWdhbGxlcnktY29udGFpbmVyJylcbiAgaWYgKCFlbGVtZW50cy5sZW5ndGgpIHJldHVybiBmYWxzZVxuICBsb2FkU3R5bGUoJ2h0dHBzOi8vdW5wa2cuY29tL2xpZ2h0Z2FsbGVyeS5qcy9kaXN0L2Nzcy9saWdodGdhbGxlcnkubWluLmNzcycpXG4gIGxvYWRTY3JpcHQoJ2h0dHBzOi8vdW5wa2cuY29tL2xpZ2h0Z2FsbGVyeS5qcy9kaXN0L2pzL2xpZ2h0Z2FsbGVyeS5qcycsICgpID0+IHtcbiAgICBlbGVtZW50cy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgaXRlbS5xdWVyeVNlbGVjdG9yQWxsKCcua2ctZ2FsbGVyeS1pbWFnZScpLmZvckVhY2goc3ViID0+IHtcbiAgICAgICAgc3ViLmRhdGFzZXQuc3JjID0gc3ViLmNoaWxkcmVuWzBdLnNyY1xuICAgICAgfSlcbiAgICAgIHdpbmRvdy5saWdodEdhbGxlcnkoaXRlbSwgeyBzZWxlY3RvcjogJy5rZy1nYWxsZXJ5LWltYWdlJyB9KVxuICAgIH0pXG4gIH0pXG59KSgpXG5cbi8vIFRPRE86IHBvc3Qgc2hhcmVcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG47KCgpID0+IHtcbiAgcXNhKCcucG9zdC1zaGFyZSBhJykuZm9yRWFjaChpdGVtID0+IGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHtcbiAgICB3aW5kb3cub3BlbihlLmN1cnJlbnRUYXJnZXQuaHJlZiwgJ3NoYXJlLXdpbmRvdycsICd3aWR0aD02NDAsaGVpZ2h0PTM2MCcpXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gIH0pKVxufSkoKVxuXG4vLyBzdWJzY3JpYmUgaGlkZGVuIGZvcm0gdmFsdWVcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG47KCgpID0+IHtcbiAgcXNhKCdpbnB1dFtuYW1lPWxvY2F0aW9uXScpLmZvckVhY2goaXRlbSA9PiB7IGl0ZW0udmFsdWUgPSBpdGVtLnZhbHVlIHx8IGxvY2F0aW9uLmhyZWYgfSlcbiAgcXNhKCdpbnB1dFtuYW1lPXJlZmVycmVyXScpLmZvckVhY2goaXRlbSA9PiB7IGl0ZW0udmFsdWUgPSBpdGVtLnZhbHVlIHx8IGRvY3VtZW50LnJlZmVycmVyIH0pXG59KSgpXG5cbi8vIHNpdGUgcHJlbG9hZGVyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuOygoKSA9PiB7XG4gIGNvbnN0IGxvYWRlciA9IHFzKCcuc2l0ZS1wcmVsb2FkZXInKVxuICBpZiAobG9hZGVyKSB7XG4gICAgbG9hZGVyLnN0eWxlLm9wYWNpdHkgPSAwXG4gICAgc2V0VGltZW91dCgoKSA9PiBsb2FkZXIucGFyZW50RWxlbWVudC5yZW1vdmVDaGlsZChsb2FkZXIpLCAxMDAwKVxuICB9XG59KSgpXG4iXSwiZmlsZSI6Imdsb2JhbC5qcyJ9
